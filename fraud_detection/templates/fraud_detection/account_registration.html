{% extends "base.html" %}
{% load static %}

{% block Title %} Payment {% endblock Title %}
{% block BodyClassToggler %}loginWrapper{% endblock BodyClassToggler %}

{% block Content %}
<div class="background-placeholder">
  <img src="{% static 'img/creditimg.jpg' %}" alt="">
</div>

<form action="" method="post" class="form-horizontal form-payment">
    {% csrf_token %}
    <h3 class="text-center text-white "> Account Registration Form </h3>
    <div class="lines mb-3">
        <hr class="m-2" style="width: 50px; height: 3px; color: #CB69C1;">
        <hr class="m-2" style="width: 50px; height: 3px; color: #BE81EA;">
    </div>
  <div class="row">
  <div class="col-md-6">
  
    <!-- Account section -->
    <h4 class="text-white">Account</h4>
    <div class="form-group">
        <!-- <div class="row">
            <div class="col-md-6"> -->
                <div class=" input-group mb-3">
                    <span class="input-group-text" id="basic-addon1"><i class="fa fa-user icon"></i></span>
                    <input name='fullname' required type="text" class="form-control" placeholder="Fullname" aria-label="fullname"
                        aria-describedby="basic-addon1"
                        value="{{request.session.fullname}}"
                        >
                </div>
            <!-- </div>
            <div class="col-md-6 col-sm-6"> -->
                <div class=" input-group mb-3">
                    <span class="input-group-text" id="basic-addon1"><i class="fa fa-user icon"></i></span>
                    <input name='username' required type="text" class="form-control" placeholder="Username" aria-label="username"
                        aria-describedby="basic-addon1"
                        value="{{ request.session.username}}"
                        
                        >
                </div>
            <!-- </div>
        </div> -->
    </div>
  
    <!-- Email text -->
    <div class="input-group mb-3">
        <span class="input-group-text" id="basic-addon1">   <i class="fa fa-envelope icon"></i> </span>
        <input id='email'  required type="email" class="form-control" placeholder="Email" aria-label="email" name="email"
            aria-describedby="basic-addon1"
            value="{{request.session.email}}"
            >
    </div>
  
    <!--Address text -->
    <div class="input-group mb-3">
        <span class="input-group-text" id="basic-addon1">  <i class="fa fa-map-marker icon" aria-hidden="true"></i></span>
        <input required type="text" class="form-control" placeholder="Address" aria-label="address" name="address"
            aria-describedby="basic-addon1">
    </div>
  
    <!--City text -->
    <div class="input-group mb-3">
        <span class="input-group-text" id="basic-addon1"><i class="fa fa-institution icon"></i></span>
        <input required type="text" class="form-control" placeholder="City" aria-label="city" name="city"
            aria-describedby="basic-addon1">
    </div>
  
    <!-- Date of birth-->
    <div class="form-group">
        <div class="row">
            <div class="col-md-12">
                <label class="mb-2 col-md-6 col-sm-6 control-label" for="dob">
                    Date of Birth
                </label> 
                <input required name="dob" type="date" class=" mb-3 form-control input-md">
            </div>
  
            <div class="col-md-12 col-sm-6 ">
                <label class="mb-2 col-md-6 col-sm-6 control-label" for="">
                    Gender
                </label> 
                <div class="gender d-flex align-items-center gap-2">
                    <input required type="radio" name="gender" id="" value='male'>
                    <label for="male"> Male</label>
  
                    <input required type="radio" name="gender" id="" value="female">
                    <label for="female"> Female</label>
                </div>
               
            </div>
        </div>
    </div>
  </div>
  <div class="col-md-6">
    <h4 class="text-white"> Security Questions </h4>
      <!-- Security Questions field -->
      <label for="question1">Question 1 <span class="text-danger">*</span></label>
      <select name='question1' class="form-select form-control mb-2" aria-label="Default select example" required>
          <option selected>Select a  security question</option>
          <option value="What is your favourite pet's name?">What is your favourite pet's name?</option>
          <option value="What is your favourite movie?">What is your favourite movie?</option>
          <option value="What is the one word you like saying?">What is the one word you like saying?</option>
          <option value="What is your favourite teacher's name?">What is your favourite teacher's name?</option>
      </select>
      
      <!-- Answer -->
      <label for="answer1">Answer </label>
      <div class="col-md-12">
          <input name="answer1" type="text"  class="mb-3 form-control" required>
      </div>

       <!-- Security Questions field -->
       <label for="question2">Question 2 <span class="text-danger">*</span></label>
       <select name="question2" class="form-select form-control mb-2" aria-label="Default select example" required>
           <option selected>Select a  security question</option>
           <option value="What is your favourite pet's name?">What is your favourite pet's name?</option>
           <option value="What is your favourite movie?">What is your favourite movie?</option>
           <option value="What is the one word you like saying?">What is the one word you like saying?</option>
           <option value="What is your favourite teacher's name?">What is your favourite teacher's name?</option>
       </select>
       
       <!-- Answer -->
       <label for="answer2">Answer </label>
       <div class="col-md-12">
           <input name="answer2" type="text"  class="mb-3 form-control" required>
       </div>

        <!-- Security Questions field -->
      <label for="question3">Question 3 <span class="text-danger">*</span></label>
      <select name='question3' class="form-select form-control mb-2" aria-label="Default select example" required>
          <option selected>Select a  security question</option>
          <option value="What is your favourite pet's name?">What is your favourite pet's name?</option>
          <option value="What is your favourite movie?">What is your favourite movie?</option>
          <option value="What is the one word you like saying?">What is the one word you like saying?</option>
          <option value="What is your favourite teacher's name?">What is your favourite teacher's name?</option>
      </select>
      
      <!-- Answer -->
      <label for="answer3">Answer </label>
      <div class="col-md-12">
          <input name="answer3" type="text"  class="mb-3 form-control" required>
      </div>







  </div>
</div>


   <!-- Button -->
   <div class="form-group text-center">
      <div class="col-md-12">
          <button id="account-button" type="submit" class="form-control btn btn-success"> Create Account </button>
      </div>
  </div>
  





</form>

</body>
{% endblock Content %}


{% block Script %}
  <script>

    // 

    const setCardNumber = val => {
      document.querySelector('input[name^="card_number"').value = val
    }

    const input_pattern = (dom, event) => {
        const dash_pattern = [4, 9, 14]
        var str = dom.value;

        if(event.keyCode === 8)
          return;


        if(str.length > 19){
          setCardNumber(str.slice(0,-1))
        }


        if(dash_pattern.includes(str.length)){
          str += '-'
          setCardNumber(str)
        }

    }

    const toggleSmallDisplay = (text, input, show=false) => {
      const small = input.parentElement.nextElementSibling
      if(show){

        small.setAttribute('class', 'error')
        small.textContent = text

      }
      else
        small.classList.remove('error') 

    }

    const inputMaxLength = (max, input) => {

      const small = document.createElement('small')
      small.setAttribute('class', 'text-warning')

      const len = input.name === 'card_number' ? 16 : 8

      if(input.value.length < max || input.value.length > max){
        toggleSmallDisplay('must have ' + len + ' characters', input, true)
      }else{
        toggleSmallDisplay(' must have ' + len + ' characters', input, false)
      }
       

    }

    // validation forms
    const addEventsToInputs = () => {
        const inputs = document.querySelectorAll('input[name^="card_"]')
        console.log(inputs)
        inputs.forEach( input => {
            input.addEventListener('keyup', function(e){

                if(this.name ==='card_number'){
                  const card_number_dom = this
               
                  input_pattern(card_number_dom, e)

                  inputMaxLength(19, card_number_dom)
                  
                }
                if(this.name ==='card_serial'){
                  const card_number_dom = this
               
                  inputMaxLength(7, card_number_dom)

                }

          
            })
        })
    }




    /**** Start ****/
    (function() {
       /* addEventsToInputs() */
    })()

  </script>
{% endblock Script %}